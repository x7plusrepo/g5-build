"use strict";(self.webpackChunkproject_g5=self.webpackChunkproject_g5||[]).push([[3862],{7062:function(n,e,t){t.r(e),t.d(e,{default:function(){return N}});var i,r,o,a,s,c,l,d=t(4165),u=t(1413),h=t(5861),g=t(885),x=t(7313),p=t(3222),v=t(5627),m=t(2668),f=t(790),j=t(6069),Z=t(1359),b=t(4641),k=function(){var n=(0,x.useState)(!1),e=(0,g.Z)(n,2),t=e[0],i=e[1],r=(0,x.useState)([]),o=(0,g.Z)(r,2),a=o[0],s=o[1],c=function(n){var e,t,r=null===n||void 0===n||null===(e=n.coords)||void 0===e?void 0:e.latitude,o=null===n||void 0===n||null===(t=n.coords)||void 0===t?void 0:t.longitude,a="https://rsapi.goong.io/Geocode?latlng=".concat(r,",").concat(o,"&api_key=quhmmkZwSmXStActFm3t9poJjOR5EE5jXygR2pt7");fetch(a).then((function(n){return n.json()})).then((function(n){var e=n||{},t=e.status,r=e.results;"OK"===t&&(i(!1),s(r||[]))})).catch((function(n){return i(!1)}))};return{isLoading:t,reversedAddress:a,getCurrentLocation:function(){var n;null!==(n=navigator)&&void 0!==n&&n.geolocation&&(i(!0),navigator.geolocation.getCurrentPosition(c))}}},y=t(1677),C=t(5222),w=t(6947),S=t(3070),P=t(7123),I=t(3454),E=t(5164),F=t(2153),q=t(1237),L=t(168),A=t(3115),T=t(7648),M=A.ZP.div(i||(i=(0,L.Z)(["\n  font-size: 12px;\n  padding: 0 5px 120px;\n"]))),R=A.ZP.div(r||(r=(0,L.Z)(["\n  display: flex;\n  align-items: ",";\n"])),(function(n){return n.alignItems||"center"})),_=A.ZP.p(o||(o=(0,L.Z)(["\n  width: ",";\n  margin: ",";\n"])),(function(n){return n.width}),(function(n){return n.margin})),z=A.ZP.p(a||(a=(0,L.Z)(["\n  font-weight: 600;\n  margin: ",";\n"])),(function(n){return n.margin})),O=A.ZP.textarea(s||(s=(0,L.Z)(["\n  width: 100%;\n  height: 50px;\n  padding: 5px;\n  margin: 10px 0 0;\n  border-radius: 5px;\n  border: 1px solid ",";\n  &:focus-visible {\n    outline: none;\n  }\n"])),q.Z.rgbaGray),B=(A.ZP.div(c||(c=(0,L.Z)(["\n  background-color: #000;\n  height: 300px;\n"]))),(0,A.ZP)(T.Z)(l||(l=(0,L.Z)(["\n  cursor: pointer;\n  color: ",";\n"])),q.Z.brightBlue),t(2790)),D=t.n(B),H=t(6417),K=(0,x.lazy)((function(){return t.e(9146).then(t.bind(t,9146))})),Q=(0,x.lazy)((function(){return Promise.all([t.e(4660),t.e(9203)]).then(t.bind(t,9436))})),G=(0,x.lazy)((function(){return t.e(1658).then(t.bind(t,1658))})),J=function(n){var e,t=n.refetchConversations,i=(0,v.cI)({defaultValues:{}}),r=i.register,o=i.handleSubmit,a=i.formState.errors,s=(0,p.I0)(),c="images",l="customer",L=x.useState([]),A=(0,g.Z)(L,2),T=A[0],B=A[1],J=(0,x.useState)(!1),N=(0,g.Z)(J,2),V=N[0],X=N[1],U=(0,x.useState)(null),$=(0,g.Z)(U,2),W=$[0],Y=$[1],nn=k(),en=nn.reversedAddress,tn=nn.getCurrentLocation,rn=nn.isLoading,on=(null===(e=en[0])||void 0===e?void 0:e.formatted_address)||null,an=(W||{}).fullName,sn=(0,m.a)(P.bV).data,cn=sn&&sn.global||{},ln=cn.isRequiredTakePhoto,dn=cn.isRequiredLocationCheck;r(l,{required:!W}),r(c,{required:!T.length&&ln}),r("location",{required:!on&&dn});var un=W?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(_,{width:"70px",children:"Kh\xe1ch h\xe0ng"}),(0,H.jsxs)(z,{children:[": ",an]}),(0,H.jsx)(y.Z,{label:"\u0110\u1ed5i",onClick:function(){return Y(null)}})]}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(_,{width:"80px",children:"Kh\xe1ch h\xe0ng :"}),(0,H.jsx)(Z.Z,{width:"90%",isSelectOne:!0,isError:!!a.customer,roles:[S.If.CUSTOMER,S.If.LEAD],onClickSelectResultItem:function(n){Y(null===n||void 0===n?void 0:n.node)}})]}),hn=on?(0,H.jsxs)(H.Fragment,{children:[on,(0,H.jsx)(y.Z,{label:"C\u1eadp nh\u1eadt",onClick:tn})]}):rn?"\u0110ang l\u1ea5y v\u1ecb tr\xed...":(0,H.jsx)(b.Z,{margin:"0",label:"L\u1ea5y v\u1ecb tr\xed hi\u1ec7n t\u1ea1i",disabled:rn,onClick:tn}),gn=!!a.images&&!on,xn=(0,f.D)(I.E1,{onError:function(){s((0,E.S4)()),s((0,F.AP)());var n={title:"L\u1ed7i",children:(0,H.jsx)("p",{children:"Hi\u1ec7n t\u1ea1i h\u1ec7 th\u1ed1ng \u0111ang b\u1ea3o tr\xec vui l\xf2ng quay l\u1ea1i sau!"})};s((0,F.om)(n))}}),pn=(0,g.Z)(xn,1)[0],vn=function(){var n=(0,h.Z)((0,d.Z)().mark((function n(e){var i,r,o,a;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s((0,E.S$)()),i=e.content,r=(W||{})._id,o=T.map((function(n){return(0,j.tg)({imageSrc:n,canvasId:"conversation-canvas"})})),a=(0,u.Z)((0,u.Z)({},i&&{content:i}),{},{images:o,customerAccountId:r,location:on}),n.next=7,pn({variables:{data:a}});case 7:n.sent.data&&(t(),s((0,E.S4)()),s((0,F.AP)()));case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,H.jsxs)(M,{children:[(0,H.jsxs)(C.Z,{children:[(0,H.jsx)(R,{children:un}),(0,H.jsxs)(R,{alignItems:"flex-start",children:[(0,H.jsx)(_,{width:"70px",children:"\u0110\u1ecba \u0111i\u1ec3m"}),(0,H.jsxs)("div",{style:{width:"85%"},children:[(0,H.jsxs)(_,{children:[": ",hn]}),(0,H.jsx)(w.Z,{isError:gn,margin:"0 5px"})]})]}),(0,H.jsx)(O,(0,u.Z)((0,u.Z)({},r("content",{required:!ln&&!dn})),{},{placeholder:"Nh\u1eadp n\u1ed9i dung \u0111\xe3 trao \u0111\u1ed5i v\u1edbi kh\xe1ch h\xe0ng..."})),(0,H.jsx)(w.Z,{isError:!!a.content}),(0,H.jsx)("canvas",{id:"conversation-canvas",style:{display:"none"}}),!V&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(y.Z,{label:"+ Th\xeam \u1ea3nh",onClick:function(){var n={bodyHeight:"100%",showTopCloseButton:!1,children:(0,H.jsx)(x.Suspense,{fallback:null,children:(0,H.jsx)(G,{tookImages:T,setTookImages:B,setIsTakingPhotos:X})}),customBodyStyle:{padding:"0",width:"100%",backgroundColor:q.Z.black}};s((0,F.FJ)(n))}}),(0,H.jsx)(D(),{width:"100%",height:"100%",audio:!1,screenshotQuality:.7,screenshotFormat:"image/jpeg",videoConstraints:{facingMode:{exact:"environment"}}}),(0,H.jsx)(D(),{width:"100%",height:"300px",audio:!1,screenshotQuality:.7,screenshotFormat:"image/jpeg",videoConstraints:{facingMode:{exact:"environment"}}}),(0,H.jsx)(D(),{width:"300px",height:"300px",audio:!1,screenshotQuality:.7,screenshotFormat:"image/jpeg",videoConstraints:{facingMode:{exact:"environment"}}}),(0,H.jsx)(w.Z,{isError:!!a.images})]}),(0,H.jsx)(x.Suspense,{fallback:null,children:(0,H.jsx)(Q,{mediaData:T})})]}),(0,H.jsx)(K,{label:"TH\xcaM M\u1edaI",onClick:o(vn)})]})};J.defaultProps={};var N=J}}]);